{%- comment -%}
    Only 1 Cart Drawer should be rendered in the theme, particularly as a block inside the 'header' section.

        settings: Object containing all settings for this snippet.

    Usage: {%- render 'cart-drawer' , settings: settingsobj -%}
{%- endcomment -%}


<!-- cart-drawer.liquid.start -->

<div class="fixed top-0 left-0 w-1/6 h-screen bg-black bg-opacity-40 backdrop-filter backdrop-blur-sm z-[15] md:w-3/5 transform"
     x-show="cartOpen"
     x-transition:enter="transition-all duration-500 ease-out"
     x-transition:enter-start="!w-full !bg-opacity-0 !backdrop-blur-0"
     x-transition:leave="transition-all duration-300 ease-in"
     x-transition:leave-end="!w-full !bg-opacity-0 !backdrop-blur-0"
     x-cloak></div>

<div class="fixed top-0 right-0 w-5/6 md:w-2/5 h-screen bg-gray-50 transform overflow-y-auto z-20 pt-20 border-l shadow-2xl px-4 
            {%- if settings.glass %} bg-opacity-60 backdrop-filter backdrop-blur border-white border-opacity-20{%- endif -%}"
    x-show="cartOpen"
    x-transition:enter="transition-all duration-500 ease-out"
    x-transition:enter-start="!translate-x-full"
    x-transition:leave="transition-all duration-300 ease-in"
    x-transition:leave-end="!translate-x-full"
    @click.away="cartOpen = false"
    x-cloak>

    <div class="absolute top-0 left-0 w-1/2 p-8 mx-auto text-base min-w-max max-w-5/6">
        <svg x-show="productAdded" class="inline w-4 h-4 mx-auto mr-2 text-green-500 fill-current icon"><use xlink:href="#icon-checkmark"></use></svg>
        <span x-text="cartMessage"></span>
    </div>
    <button class="absolute top-0 right-0 p-8" @click.prevent="cartOpen = false">
        <svg class="block w-4 h-4 mx-auto icon"><use xlink:href="#icon-close"></use></svg>
    </button>

    <template x-if="cart.items.length == 0" hidden>
        <div>
            <div class="font-normal">Cart is empty</div>
            <button class="bg-green-500 rounded-sm shadow-sm" @click.prevent="fetchCart()">Fetch Cart Data</button>
        </div>
    </template>
    <template x-if="cart.items.length >= 1" hidden>
        <div class="grid w-full grid-cols-1 px-4 font-normal gap-y-3">
            <template x-for="(item, index, key) in cart.items" :key="item.key">
                <div class="flex items-center w-full gap-x-2" :product-id="item.id">
                    <img class="flex-none w-1/4 lazyload" 
                        :style="`aspect-ratio: ${item.featured_image.aspect_ratio}`" 
                        :data-src="dataImg(item.featured_image.url)" 
                        :data-aspect-ratio="item.featured_image.aspect_ratio" 
                        :alt="item.featured_image.alt"
                        data-sizes="auto"/>
                    <div class="flex-auto w-3/4">
                        <div class="text-base text-gray-900" x-text="item.product_title"></div>
                        <div class="flex w-1/2 pt-2 text-sm text-gray-700 divide-x sm:w-1/4 md:w-1/2">
                            <template x-for="(option, index) in item.options_with_values" :key="index" hidden>
                                <span class="flex-auto text-center" x-text="option.value"></span>
                            </template>
                        </div>
                    </div>
                    
                </div>
            </template>
        </div>
    </template>

</div>

<!-- cart-drawer.liquid.end -->